
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="api/apollo_rock_thin_section_classifier/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Apollo Rock Thin Section Classifier</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/mkapi-common.css">
    
      <link rel="stylesheet" href="css/mkapi-material.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apollo-rock-thin-section-classifier" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Apollo Rock Thin Section Classifier" class="md-header__button md-logo" aria-label="Apollo Rock Thin Section Classifier" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Apollo Rock Thin Section Classifier
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Apollo Rock Thin Section Classifier
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Apollo Rock Thin Section Classifier" class="md-nav__button md-logo" aria-label="Apollo Rock Thin Section Classifier" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Apollo Rock Thin Section Classifier
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Apollo Rock Thin Section Classifier
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Apollo Rock Thin Section Classifier
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-sources" class="md-nav__link">
    <span class="md-ellipsis">
      Data Sources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      Models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binary-classifier" class="md-nav__link">
    <span class="md-ellipsis">
      Binary Classifier:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Binary Classifier:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#machine-learning-ai-components" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning / AI Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine Learning / AI Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stratified_group_kfoldpy" class="md-nav__link">
    <span class="md-ellipsis">
      stratified_group_kfold.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preprocessing_helperpy" class="md-nav__link">
    <span class="md-ellipsis">
      preprocessing_helper.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networkspy" class="md-nav__link">
    <span class="md-ellipsis">
      networks.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Preprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#full_database_tree" class="md-nav__link">
    <span class="md-ellipsis">
      full_database_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pds_datamsm" class="md-nav__link">
    <span class="md-ellipsis">
      pds_data.msm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lunar_institute_datamsm" class="md-nav__link">
    <span class="md-ellipsis">
      lunar_institute_data.msm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combined_data2xmsm" class="md-nav__link">
    <span class="md-ellipsis">
      combined_data2x.msm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_downloaderpy" class="md-nav__link">
    <span class="md-ellipsis">
      sample_downloader.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-imagefinder" class="md-nav__link">
    <span class="md-ellipsis">
      Class: ImageFinder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lbl_parserpy" class="md-nav__link">
    <span class="md-ellipsis">
      lbl_parser.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing_combinedpy" class="md-nav__link">
    <span class="md-ellipsis">
      processing_combined.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msm_statistics_combinedpy" class="md-nav__link">
    <span class="md-ellipsis">
      msm_statistics_combined.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-and-removing-packages" class="md-nav__link">
    <span class="md-ellipsis">
      Adding and Removing Packages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-built-in-commands" class="md-nav__link">
    <span class="md-ellipsis">
      All Built-in Commands
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-word-on-modules-and-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      A Word on Modules and Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A Word on Modules and Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Scripts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-test-coverage-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Test Coverage Calculation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-spaces" class="md-nav__link">
    <span class="md-ellipsis">
      Code Spaces
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            apollo_rock_thin_section_classifier
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.data_management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            apollo_rock_thin_section_classifier.data_management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.data_management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/lbl_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.data_management.lbl_parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/msm_statistics_combined/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Msm statistics combined
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/preprocessing_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocessing datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/preprocessing_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocessing images
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/processing_combined/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Processing combined
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/sample_downloader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sample downloader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/scrape_microscope_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scrape microscope info
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/data_management/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.data_management.utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.plotting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            apollo_rock_thin_section_classifier.plotting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/plotting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.plotting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/plotting/augmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.plotting.augmentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/apollo_rock_thin_section_classifier/plotting/create_figures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apollo_rock_thin_section_classifier.plotting.create_figures
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-sources" class="md-nav__link">
    <span class="md-ellipsis">
      Data Sources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      Models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binary-classifier" class="md-nav__link">
    <span class="md-ellipsis">
      Binary Classifier:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Binary Classifier:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#machine-learning-ai-components" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning / AI Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine Learning / AI Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stratified_group_kfoldpy" class="md-nav__link">
    <span class="md-ellipsis">
      stratified_group_kfold.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preprocessing_helperpy" class="md-nav__link">
    <span class="md-ellipsis">
      preprocessing_helper.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networkspy" class="md-nav__link">
    <span class="md-ellipsis">
      networks.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Preprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#full_database_tree" class="md-nav__link">
    <span class="md-ellipsis">
      full_database_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pds_datamsm" class="md-nav__link">
    <span class="md-ellipsis">
      pds_data.msm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lunar_institute_datamsm" class="md-nav__link">
    <span class="md-ellipsis">
      lunar_institute_data.msm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combined_data2xmsm" class="md-nav__link">
    <span class="md-ellipsis">
      combined_data2x.msm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_downloaderpy" class="md-nav__link">
    <span class="md-ellipsis">
      sample_downloader.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-imagefinder" class="md-nav__link">
    <span class="md-ellipsis">
      Class: ImageFinder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lbl_parserpy" class="md-nav__link">
    <span class="md-ellipsis">
      lbl_parser.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing_combinedpy" class="md-nav__link">
    <span class="md-ellipsis">
      processing_combined.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msm_statistics_combinedpy" class="md-nav__link">
    <span class="md-ellipsis">
      msm_statistics_combined.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-and-removing-packages" class="md-nav__link">
    <span class="md-ellipsis">
      Adding and Removing Packages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-built-in-commands" class="md-nav__link">
    <span class="md-ellipsis">
      All Built-in Commands
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-word-on-modules-and-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      A Word on Modules and Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A Word on Modules and Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Scripts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-test-coverage-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Test Coverage Calculation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-spaces" class="md-nav__link">
    <span class="md-ellipsis">
      Code Spaces
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="apollo-rock-thin-section-classifier">Apollo Rock Thin Section Classifier</h1>
<p>This document outlines the functionality of various approaches within the Thin Slice Classifier project.</p>
<hr />
<p><a href="https://esa.github.io/apollo_rock_thin_section_classifier"><img alt="Documentation" src="https://img.shields.io/badge/docs-passing-green" /></a>
<a href="https://github.com/esa/apollo_rock_thin_section_classifier/commits/main"><img alt="LastCommit" src="https://img.shields.io/github/last-commit/esa/apollo_rock_thin_section_classifier" /></a></p>
<p>Authors: Freja Thoresen, Aidan Cowley, Romeo Haak, Jonas Lewe, Clara Moriceau, Piotr Knapczyk, Victoria Engelschion</p>
<h2 id="data-sources">Data Sources</h2>
<ul>
<li>NASA PDS database (https://pdsimage2.wr.usgs.gov/Missions/Apollo/Lunar_Sample_Photographs/)</li>
<li>Lunar Institute Data (https://www.lpi.usra.edu/lunar/samples/atlas/thin_sections/)</li>
<li>Virtual Microscope (http://www.virtualmicroscope.org/explore)</li>
</ul>
<h2 id="models">Models</h2>
<p>Trained models can be downloaded from wandb.</p>
<p>https://wandb.ai/freja-thoresen/SimCLR
https://wandb.ai/freja-thoresen/Geological%20Binary%20Classifier</p>
<h2 id="binary-classifier">Binary Classifier:</h2>
<p>To execute the binary classifier, run the <code>msm_statistics.py</code> script using the following command: </p>
<div class="highlight"><pre><span></span><code>combined_data2x.msm<span class="w"> </span>&lt;image_directory_name&gt;
</code></pre></div>
<p>This command will generate a "datasets" folder containing two sub-folders: "grain" and "rock_type". For example, in the "rock_type" sub-folder, images will be classified into either a "breccia" or a "basalt" folder based on the generated classification dictionary. Additionally, sample IDs will be added as prefixes to the existing file names for easier management. If using the binary classifier, ensure to remove the "other" folder.</p>
<hr />
<h3 id="machine-learning-ai-components">Machine Learning / AI Components</h3>
<p>This section assumes you have completed the Quick Guide in the <code>Set everything up</code> section.</p>
<h4 id="stratified_group_kfoldpy">stratified_group_kfold.py</h4>
<p>This script creates data folds, ensuring that images from the same sample are grouped together in either the training or testing sets. It is utilized by <code>preprocessing_helper.py</code>.</p>
<h4 id="preprocessing_helperpy">preprocessing_helper.py</h4>
<p>This file is responsible for cleaning and organizing folders for training, testing, and validation. It ensures that images from the same sample are stored together. </p>
<h4 id="networkspy">networks.py</h4>
<p>This is the core component of the binary classifier, which is responsible for training and fine-tuning the networks. </p>
<p>You can adjust the network type and parameters by the following:</p>
<div class="highlight"><pre><span></span><code><span class="n">network</span> <span class="o">=</span> <span class="n">InceptionResNet</span><span class="p">(</span><span class="n">training_directory</span><span class="p">,</span> <span class="n">validation_directory</span><span class="p">,</span> <span class="n">test_directory</span><span class="p">,</span> 
                          <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">finetune_epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</code></pre></div>
<p>The available networks include VGG16, VGG19, and InceptionResNet. Additional functionalities include:
- <code>-c</code>: Enables cross-validation training
- <code>-f</code>: Enables fine-tuning after initial training
- <code>-x</code>: Executes experiment 1 to check for repeated false positives
- <code>-t</code>: Runs for only 2 epochs for testing purposes
- <code>-g</code>: Draws precision-recall curves (not available for cross-validation)
- <code>-T</code>: Evaluates model performance on the test set</p>
<p>To train the network for rock type prediction, use:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>networks.py<span class="w"> </span>-f<span class="w"> </span>-T<span class="w"> </span>../datasets/rock_type
</code></pre></div>
<hr />
<h2 id="preprocessing">Preprocessing</h2>
<p>While not necessary for running the classifier, understanding the following information can be helpful regarding saved and processed files.</p>
<h4 id="full_database_tree">full_database_tree</h4>
<p>Contains links to all high-resolution JPEG and TIF images in the PDS database. This is used in the <code>download_labels</code> function within <code>sample_downloader.py</code>.</p>
<h4 id="pds_datamsm">pds_data.msm</h4>
<p>This file contains the moon sample metadata (msm) for the data from the PDS database.
Essentially, this file contains information about the sample, specifying its superclass, subclass, sample ID, etc.</p>
<p>See https://pdsimage2.wr.usgs.gov/Missions/Apollo/Lunar_Sample_Photographs/A14VIS_0001/DATA/BASALT/FELDSPATHIC/14053/THIN_SECTIONS/S71-23315.LBL
for an example</p>
<p>This file is a product of running lbl_parser.py. This file is used in processing_combined.py and statistic_combined.py
if using the MsmStatisticsPdsimage class.</p>
<h4 id="lunar_institute_datamsm">lunar_institute_data.msm</h4>
<p>This file serves a similar purpose to <code>pds_data.msm</code> but employs a slightly different data structure.</p>
<p>See https://www.lpi.usra.edu/lunar/samples/atlas/thin_section/?mission=Apollo%2011&amp;sample=10058&amp;source_id=JSC04230 for an example of the data saved.</p>
<p>This file is also utilized in <code>processing_combined.py</code>.</p>
<h4 id="combined_data2xmsm">combined_data2x.msm</h4>
<p><strong>IMPORTANT FILE.</strong> This file consolidates data from the lunar sample atlas and NASA's PDS. It also indicates grain size and rock type for the samples.</p>
<p>To create this file:
1. Combine <code>lunar_institute.msm</code> and <code>pds_data.msm</code> using <code>combine_pds_and_lunar()</code> in <code>processing_combined.py</code>.
2. Run the following lines of code with the newly created <code>combined_data.msm</code> in <code>processing_combined.py</code> to generate <code>combined_data2x.msm</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">data_msm</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;combined_data.msm&quot;</span><span class="p">)</span>
<span class="n">data_msm</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">change_paths</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_msm</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">write_to_file</span><span class="p">(</span><span class="n">data_msm</span><span class="p">,</span> <span class="s1">&#39;combined_data2x.msm&#39;</span><span class="p">)</span>
</code></pre></div>
<p>This file is referenced by <code>msm_statistics_combined.py</code>.</p>
<h4 id="sample_downloaderpy">sample_downloader.py</h4>
<p>This file is usually the first point of reference for acquiring data. It contains the <code>ImageFinder</code> class responsible for compiling links from NASA's PDS image database. The <code>full_database_tree</code> is also available on GitHub for immediate use.</p>
<h3 id="class-imagefinder">Class: ImageFinder</h3>
<p>You can use this class as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">image_finder</span> <span class="o">=</span> <span class="n">ImageFinder</span><span class="p">()</span>
<span class="n">image_finder</span><span class="o">.</span><span class="n">director</span><span class="p">(</span><span class="o">&lt;</span><span class="n">mode</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div>
<p>The director method has three modes: 'combine', 'all', and 'missed only'. Depending on your needs, replace <code>&lt;mode&gt;</code> with one of these valid options. Running in "all" mode assumes you don't have any data yet and will attempt to scrape all links from NASA's PDS database located at: 
https://pdsimage2.wr.usgs.gov/Missions/Apollo/Lunar_Sample_Photographs/. </p>
<p>Please note that the site may occasionally close connections to prevent bot behavior. If this occurs while in "full" mode, any links that could not be accessed will be saved to a file named 'leftover_urls'.</p>
<p>If you then run the director in "missed only" mode, it will retry accessing the missed URLs and attempt to scrape those links and their subdirectories. After calling "full" and "missed only" once, you should have all the links you need. Finally, you can run the director in "combine" mode to merge the results from the "database_tree" file produced by the "full" mode and "database_tree_rest" from the "missed only" mode into a single file called "full_database_tree".</p>
<p>Once you've created the "full_database_tree" file, you can use it to download label files and images. It is recommended to download the label files first, as they are essential for preprocessing. To download the labels, use:</p>
<div class="highlight"><pre><span></span><code><span class="n">all_urls</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;full_database_tree&#39;</span><span class="p">)</span>
<span class="n">download_labels</span><span class="p">(</span><span class="n">all_urls</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">))</span>
</code></pre></div>
<p>Be aware that the same issue of the remote host closing the connection might occur here as well, so you may need to run this function multiple times. Don't worry; it will inform you when everything has succeeded. </p>
<p>The other functions in this module are mainly used by different files but serve to fetch or download the actual images of a sample. The most critical function among them is <code>process_local_samples</code>.</p>
<h3 id="lbl_parserpy">lbl_parser.py</h3>
<p>This file is responsible for parsing the label files from the PDS database. You can run the script using:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>lbl_parser.py<span class="w"> </span>&lt;Directory<span class="w"> </span>where<span class="w"> </span>label<span class="w"> </span>files<span class="w"> </span>are<span class="w"> </span>stored&gt;<span class="w"> </span>&lt;Desired<span class="w"> </span>filename&gt;
</code></pre></div>
<p>If everything is successful, you should receive an output file named <code>pds_data.msm</code>.</p>
<h3 id="processing_combinedpy">processing_combined.py</h3>
<p>This is an important file that assists in cleaning up and combining the two MSM files obtained from the PDS and LPI databases. It standardizes the information saved from both files into one. Call the necessary functions as needed.</p>
<h3 id="msm_statistics_combinedpy">msm_statistics_combined.py</h3>
<p>This file is tasked with extracting specific statistics and information. Depending on which MSM file you are using, you'll need to select the appropriate class.</p>
<p>For example, if you're using <code>combined_data2x.msm</code>, the relevant class is <code>MSMCombinedStatistics</code>. In that case, you can initialize it like so on line 213:</p>
<div class="highlight"><pre><span></span><code><span class="n">statistic_type</span> <span class="o">=</span> <span class="n">MsmCombinedStatistics</span><span class="p">(</span><span class="n">data_msm</span><span class="p">)</span>
</code></pre></div>
<h2 id="setup">Setup</h2>
<h3 id="installation">Installation</h3>
<ol>
<li>Run <code>make install</code>, which sets up a virtual environment and all Python dependencies therein.</li>
<li>Run <code>source .venv/bin/activate</code> to activate the virtual environment.</li>
<li>(Optional) Run <code>make install-pre-commit</code>, which installs pre-commit hooks for linting, formatting and type checking.</li>
</ol>
<h3 id="adding-and-removing-packages">Adding and Removing Packages</h3>
<p>To install new PyPI packages, run:
<div class="highlight"><pre><span></span><code>uv add &lt;package-name&gt;
</code></pre></div></p>
<p>To remove them again, run:
<div class="highlight"><pre><span></span><code>uv remove &lt;package-name&gt;
</code></pre></div></p>
<p>To show all installed packages, run:
<div class="highlight"><pre><span></span><code>uv pip list
</code></pre></div></p>
<h2 id="all-built-in-commands">All Built-in Commands</h2>
<p>The project includes the following convenience commands:</p>
<ul>
<li><code>make install</code>: Install the project and its dependencies in a virtual environment.</li>
<li><code>make install-pre-commit</code>: Install pre-commit hooks for linting, formatting and type checking.</li>
<li><code>make lint</code>: Lint the code using <code>ruff</code>.</li>
<li><code>make format</code>: Format the code using <code>ruff</code>.</li>
<li><code>make type-check</code>: Type check the code using <code>mypy</code>.</li>
<li><code>make test</code>: Run tests using <code>pytest</code> and update the coverage badge in the readme.</li>
<li><code>make docker</code>: Build a Docker image and run the Docker container.</li>
<li><code>make docs</code>: View documentation locally in a browser.</li>
<li><code>make publish-docs</code>: Publish documentation to GitHub Pages.</li>
<li><code>make tree</code>: Show the project structure as a tree.</li>
</ul>
<h2 id="a-word-on-modules-and-scripts">A Word on Modules and Scripts</h2>
<p>In the <code>src</code> directory there are two subdirectories, <code>apollo_rock_thin_section_classifier</code>
and <code>scripts</code>. This is a brief explanation of the differences between the two.</p>
<h3 id="modules">Modules</h3>
<p>All Python files in the <code>apollo_rock_thin_section_classifier</code> directory are <em>modules</em>
internal to the project package. Examples here could be a general data loading script,
a definition of a model, or a training function. Think of modules as all the building
blocks of a project.</p>
<p>When a module is importing functions/classes from other modules we use the <em>relative
import</em> notation - here's an example:</p>
<div class="highlight"><pre><span></span><code>from .other_module import some_function
</code></pre></div>
<h3 id="scripts">Scripts</h3>
<p>Python files in the <code>scripts</code> folder are scripts, which are short code snippets that
are <em>external</em> to the project package, and which is meant to actually run the code. As
such, <em>only</em> scripts will be called from the terminal. An analogy here is that the
internal <code>numpy</code> code are all modules, but the Python code you write where you import
some <code>numpy</code> functions and actually run them, that a script.</p>
<p>When importing module functions/classes when you're in a script, you do it like you
would normally import from any other package:</p>
<div class="highlight"><pre><span></span><code>from apollo_rock_thin_section_classifier import some_function
</code></pre></div>
<p>Note that this is also how we import functions/classes in tests, since each test Python
file is also a Python script, rather than a module.</p>
<h2 id="features">Features</h2>
<h3 id="docker-setup">Docker Setup</h3>
<p>A Dockerfile is included in the new repositories, which by default runs
<code>src/scripts/main.py</code>. You can build the Docker image and run the Docker container by
running <code>make docker</code>.</p>
<h3 id="automatic-documentation">Automatic Documentation</h3>
<p>Run <code>make docs</code> to create the documentation in the <code>docs</code> folder, which is based on
your docstrings in your code. You can publish this documentation to Github Pages by
running <code>make publish-docs</code>. To add more manual documentation pages, simply add more
Markdown files to the <code>docs</code> directory; this will automatically be included in the
documentation.</p>
<h3 id="automatic-test-coverage-calculation">Automatic Test Coverage Calculation</h3>
<p>Run <code>make test</code> to test your code, which also updates the "coverage badge" in the
README, showing you how much of your code base that is currently being tested.</p>
<h3 id="continuous-integration">Continuous Integration</h3>
<p>Github CI pipelines are included in the repo, running all the tests in the <code>tests</code>
directory, as well as building online documentation, if Github Pages has been enabled
for the repository (can be enabled on Github in the repository settings).</p>
<h3 id="code-spaces">Code Spaces</h3>
<p>Code Spaces is a new feature on Github, that allows you to develop on a project
completely in the cloud, without having to do any local setup at all. This repo comes
included with a configuration file for running code spaces on Github. When hosted on
<code>esa/apollo_rock_thin_section_classifier</code> then simply press the <code>&lt;&gt; Code</code> button
and add a code space to get started, which will open a VSCode window directly in your
browser.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="javascript/mkapi.js"></script>
      
    
  </body>
</html>